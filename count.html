<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta name="robots" content="all" />
    <meta name="MSSmartTagsPreventParsing" content="true" />
    <meta http-equiv="imagetoolbar" content="false" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style2.css">
</head>

<body id="page" style="background-color: #2ecc71;">

    <p id="timeRemaining"></p>
    <p style="font-size: 25px;">avant la fin de l'année</p>
    <p id="hoursRemaining"></p>
    <p style="font-size: 25px;">heures de cours restantes</p>

    <div style="display: flex; justify-content: center; margin: 1em; font-size: 2em">
        Rattrapages?
        <br/>
    </div>
    <!-- Rounded switch -->
    <div id="check">
        <label class="switch">
            <input type="checkbox" id="check_rat" onchange="update(this);">
            <span class="slider round"></span>
        </label>
    </div>
    <div style="display: flex; justify-content: center; margin: 1em; font-size: 2em">
        Redoublement?
        <br/>
    </div>
    <!-- Rounded switch -->
    <div id="check">
        <label class="switch">
            <input type="checkbox" id="check_red" onchange="update(this);">
            <span class="slider round"></span>
        </label>
    </div>
    <p id="dur" style="margin: 1em">ez</p>

    <script>
        var hoursRemaining = 0;
        function logResults(json){
            /*console.log(json["totalHours"])*/
            hoursRemaining = json["totalHours"]
            document.getElementById("hoursRemaining").innerHTML = hoursRemaining
        }

        $.ajax({
          url: "http://omnitrogen.pythonanywhere.com/getHours",
          dataType: "jsonp",
          jsonpCallback: "logResults"
        });
    </script>


    <script>
    // Set the date we're counting down to
    var countDownDate = new Date("Jun 6, 2018 20:00:00").getTime();

    function update(feature) {
        if (document.getElementById("check_rat").checked == false && document.getElementById("check_red").checked == false) {
            countDownDate = new Date("Jun 6, 2018 20:00:00").getTime();
            document.getElementById("page").style.backgroundColor = "#2ecc71"
            document.getElementById("dur").innerHTML = "ez"
            document.getElementById("hoursRemaining").innerHTML = hoursRemaining
        }
        if (document.getElementById("check_rat").checked == true && document.getElementById("check_red").checked == false) {
            countDownDate = new Date("Jun 30, 2018 20:00:00").getTime();
            document.getElementById("page").style.backgroundColor = "orange"
            document.getElementById("dur").innerHTML = "duuuur"
            document.getElementById("hoursRemaining").innerHTML = hoursRemaining
        }
        if (document.getElementById("check_rat").checked == false && document.getElementById("check_red").checked == true) {
            countDownDate = new Date("Jun 6, 2019 20:00:00").getTime();
            document.getElementById("page").style.backgroundColor = "grey"
            document.getElementById("dur").innerHTML = "gnéééé?"
            document.getElementById("hoursRemaining").innerHTML = "gnéééé?"
        }
        if (document.getElementById("check_rat").checked == true && document.getElementById("check_red").checked == true) {
            countDownDate = new Date("Jun 30, 2019 20:00:00").getTime();
            document.getElementById("page").style.backgroundColor = "#c0392b"
            document.getElementById("dur").innerHTML = "R.I.P."
            document.getElementById("hoursRemaining").innerHTML = "beaucoup trop d'"
        }
    }

    // Update the count down every second
    var x = setInterval(function() {

        // Get todays date and time
        var now = new Date().getTime();

        // Find the distance between now an the count down date
        var distance = countDownDate - now;

        // Time calculations for days, hours, minutes and seconds
        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);

        // Output the result in an element with id="timeRemaining"
        document.getElementById("timeRemaining").innerHTML = days + "j " + hours + "h " +
            minutes + "m " + seconds + "s";

        // If the count down is over, write some text
        if (distance < 0) {
            clearInterval(x);
            document.getElementById("timeRemaining").innerHTML = "LET THE FUN BEGIN! FiNaLlY :o :o :o ";
        }
    }, 100);
    </script>
    </body>
</html>